dist: bionic
language: r
cache:
  packages: yes
pandoc_version: 2.3.1
cran: https://cran.rstudio.com

env:
  global:
    - _R_CHECK_TESTS_NLINES_=0

before_install:
  - pandoc --version

jobs:
  include:
    - r: 3.3
    - r: 3.4
    - r: 3.5
    - r: 3.6
    - r: release
      name: last R and Pandoc versions
      env: PATH=$HOME/bin:$PATH
      before_install:
        - ./tools/install-pandoc.sh || true
        - pandoc --version
    - r: release
      name: last R and default Pandoc versions
      env: NETLIFY_SITE_ID=5d77c13c-e2ee-4a31-87ca-2fe657196160
      after_success:
        - "[[ ${TRAVIS_BRANCH}  = master  ]] || exit 0"
        - "[[ -z ${NETLIFY_AUTH_TOKEN} ]] && exit 0"
        - nvm install stable
        - npm install netlify-cli -g
        - Rscript -e 'pkgdown::build_site(".", document = FALSE, preview = FALSE)' && netlify deploy --prod --dir docs
    - r: devel

